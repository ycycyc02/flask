<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="/static/layui.js"></script>
    <link rel="stylesheet" href="/static/css/layui.css">
    <style>
      .layui-form-item .layui-input-inline {
          float: left;
          width: 270px;
          margin-right: 10px;
      }
      #selectFile{
        width: 26px;
        height: 26px;
        margin-right: 10px;
        background:transparent; 
        border: 1px solid #ccc
      }
    </style>
    <script src="https://cdn.bootcdn.net/ajax/libs/axios/1.1.3/axios.min.js"></script>
</head>
<body>
<div class="layui-layout layui-layout-admin">
  <div class="layui-header">
    <div class="layui-logo layui-hide-xs layui-bg-black">layout demo</div>
    <!-- 头部区域（可配合layui 已有的水平导航） -->
    <ul class="layui-nav layui-layout-left">
    </ul>
    <ul class="layui-nav layui-layout-right">
      <li class="layui-nav-item layui-hide layui-show-md-inline-block">
        <a href="javascript:;">
          <img src="//tva1.sinaimg.cn/crop.0.0.118.118.180/5db11ff4gw1e77d3nqrv8j203b03cweg.jpg" class="layui-nav-img">
          tester
        </a>
        <dl class="layui-nav-child">
          <dd><a href="">Your Profile</a></dd>
          <dd><a href="">Settings</a></dd>
          <dd><a href="">Sign out</a></dd>
        </dl>
      </li>
      <li class="layui-nav-item" lay-header-event="menuRight" lay-unselect>
        <a href="javascript:;">
          <i class="layui-icon layui-icon-more-vertical"></i>
        </a>
      </li>
    </ul>
  </div>

  <div class="layui-side layui-bg-black">
    <div class="layui-side-scroll">
      <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
      <ul class="layui-nav layui-nav-tree" lay-filter="test">
        <li class="layui-nav-item layui-nav-itemed">
          <a class="" href="javascript:;">menu group 1</a>
          <dl class="layui-nav-child">
            <dd><a href="javascript:;">menu 1</a></dd>
            <dd><a href="javascript:;">menu 2</a></dd>
            <dd><a href="javascript:;">menu 3</a></dd>
            <dd><a href="">the links</a></dd>
          </dl>
        </li>
        <li class="layui-nav-item">
          <a href="javascript:;">menu group 2</a>
          <dl class="layui-nav-child">
            <dd><a href="javascript:;">list 1</a></dd>
            <dd><a href="javascript:;">list 2</a></dd>
            <dd><a href="">超链接</a></dd>
          </dl>
        </li>
        <li class="layui-nav-item"><a href="javascript:;">click menu item</a></li>
        <li class="layui-nav-item"><a href="">the links</a></li>
      </ul>
    </div>
  </div>

  <div class="layui-body">
      <!-- <button type="button" id="selectFile"><i class="layui-icon"></i></button> -->
      <table class="layui-hide" id="test"></table>
  </div>

  <div id="add-main" style="display: none;">
    <div class="my-form">
      <br/>
        <form class="layui-form" action="/data/add1" method="POST" lay-skin="line">
            <div class="layui-form-item my-form-item">
                <label class="layui-form-label layui-icon">段序号</label>
                <div class="layui-input-inline">
                    <input type="text" name="text_id" lay-verify="required" placeholder="请输入段序号" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item my-form-item">
                <label class="layui-form-label layui-icon">原始文本</label>
                <div class="layui-input-inline">
                    <input type="text" name="text" lay-verify="required" placeholder="请输入原始文本" autocomplete="off"
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item my-form-item">
                <label class="layui-form-label layui-icon">文本实体</label>
                <div class="layui-input-inline">
                    <input type="text" name="entity" lay-verify="required" placeholder="请输入文本实体" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item my-form-item">
                <label class="layui-form-label layui-icon">知识库实体</label>
                <div class="layui-input-inline">
                    <input type="text" name="entity_kb" lay-verify="required" placeholder="请输入知识库实体" autocomplete="off"
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item my-form-item">
                <label class="layui-form-label layui-icon">数据</label>
                <div class="layui-input-inline">
                    <input type="text" name="data" lay-verify="required" placeholder="请输入数据" autocomplete="off"
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item my-form-item">
                <div class="layui-input-block item">
                    <button class="layui-btn" lay-submit="" lay-filter="demo1" id="submit1">保存</button>
                    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                </div>
            </div>
        </form>
    </div>
  </div>

  <script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
  </script>

  <script type="text/html" id="toolbarDemo">
    <div class="layui-inline" lay-event="add"><i class="layui-icon layui-icon-add-1"></i></div>
    <!-- <div class="layui-inline" lay-event="update"><i class="layui-icon layui-icon-edit"></i></div> -->
    <!-- <div class="layui-inline" lay-event="delete"><i class="layui-icon layui-icon-delete"></i></div> -->
    <button class="layui-inline" type="button" id="selectFile"><i class="layui-icon"></i></button>
  </script>

  <div id="page"></div>

  <!-- <div class="layui-footer"> -->
    <!-- 底部固定区域 -->
   <!--  底部固定区域
  </div> -->
</div>

<script>
//JS
layui.use(['upload','element', 'layer', 'util','table','laypage'], function(){
  var element = layui.element
  ,layer = layui.layer
  ,util = layui.util
  ,$ = layui.$
  ,laypage = layui.laypage
  ,upload = layui.upload
  var table = layui.table;

  table.render({
     elem: '#test'
    ,url: '/list'
    ,limit: 9
    ,page: true //是否显示分页
    , request: {
        pageName: 'pageNum' //页码的参数名称，默认：page
        ,limitName: 'pageSize' //每页数据量的参数名，默认：limit
    }
    ,cols: [[ //标题栏
      {type: 'checkbox', LAY_CHECKED: true},
      // {field: 'auto_increment_id', title: 'ID', sort: true},
      {field: 'segment_id', title: '文本id',sort: true},
      {field: 'text', title: '文本',sort: true},
      {field: 'entity', title: '实体',sort: true},
      {field: 'entity_kb', title: '实体kb',sort: true},
      {field: 'data', title: '数据',sort: true},
      // {field: 'predicate', title: '谓语',sort: true},
      // {field: 'object', title: '内容',sort: true},
      {fixed: 'right', title:'操作', toolbar: '#barDemo', width:150}
    ]]
    ,skin: 'line' //表格风格
    ,toolbar: '#toolbarDemo'//'default'
    ,parseData: function(res){ //将原始数据解析成 table 组件所规定的数据
      return {
        "code": res.code, //解析接口状态
        "msg": res.message, //解析提示文本
        "count": res.total, //解析数据长度
        "data": res.data //解析数据列表
      };
    }
  });

  //工具条事件
  //触发事件
  table.on('toolbar(test)', function(obj){
    var checkStatus = table.checkStatus(obj.config.id);
    switch(obj.event){
      case 'add':
        layer.open({
                title: '添加数据',
                /*如果是外部的html，type2，内部，type1*/
                type: 1,
                btnAlign: 'c',
                area: ['400px', '400px'],
                content: $("#add-main").html(),
                dataType: "json"
                //未做的是去监听表单提交，给后台发送ajax请求
            }
        )
        ;
      break;
      case 'delete':
        layer.msg('删除');
      break;
      case 'update':
        layer.msg('编辑');
      break;
    };
  });

  //指定允许上传的文件类型
  upload.render({
    elem: '#selectFile'
    ,url: 'http://172.20.137.106:33004/test/getTable' //此处配置你自己的上传接口即可
    ,accept: 'file' //普通文件
    ,exts: 'xlsx'
    ,field: "trainingset"
    ,done: function(res){
      layer.msg('上传成功');
      // console.log(res.data[0]);
      axios({
        method: 'POST',
        url:'/data/add',
        data:res.data
      }).then(response=>{
          console.log(response)
      })  
    }
  });

  //头部事件
  util.event('lay-header-event', {
    //左侧菜单事件
    menuLeft: function(othis){
      layer.msg('展开左侧菜单的操作', {icon: 0});
    }
    ,menuRight: function(){
      layer.open({
        type: 1
        ,content: '<div style="padding: 15px;">处理右侧面板的操作</div>'
        ,area: ['260px', '100%']
        ,offset: 'rt'
        ,anim: 5
        ,shadeClose: true
      });
    }
  });

});
</script>


</body>
</html>